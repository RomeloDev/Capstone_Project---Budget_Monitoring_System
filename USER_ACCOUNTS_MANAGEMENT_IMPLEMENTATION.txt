üéØ User Accounts Management Enhancement Plan

After analyzing client_accounts.html, here's the complete implementation plan for Claude Code:

Current State:





Basic table with user list



Minimal styling



No search/filter



No user details view



No role management UI

Proposed Enhancements:

1. Summary Dashboard Cards:





Total Users, Active, Inactive, Admins, End Users

2. Search & Filters:





Search bar (name, email, department)



Role filter dropdown



Status filter dropdown



Department filter dropdown

3. Enhanced Table:





Sortable columns



Status badges (Active=green, Inactive=gray)



Role badges (Admin=purple, End User=blue)



Last login timestamp



Quick actions per row (View, Edit, Toggle Status, Delete)



Bulk selection checkboxes

4. User Management Modals:





Create User modal



Edit User modal



User Details modal (with activity stats)



Delete Confirmation modal

5. AJAX Operations:





Create user



Edit user



Activate/Deactivate



Delete user



Bulk actions

6. Export Features:





Export users to Excel



Export filtered results



üìù Complete Prompt for Claude Code

# Enhance User Accounts Management Page

I need to completely redesign the User Accounts Management page (`client_accounts.html`) with modern UI, advanced features, and AJAX operations.

## Current File

**File:** `apps/admin_panel/templates/admin_panel/client_accounts.html`
- Basic user list table
- Minimal styling
- No advanced features

**User Model** (from `apps/users/models.py`):
- Fields: `username`, `email`, `fullname`, `department`, `position`, `mfo`, `role`, `is_active`
- Timestamps: `date_joined`, `last_login`

---

## Requirements

### 1. Summary Dashboard Cards

Add 5 cards at the top showing:
```html
<div class="grid grid-cols-5 gap-4 mb-6">
    <!-- Total Users -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-600">Total Users</p>
                <p class="text-3xl font-bold text-gray-900">{{ total_users }}</p>
            </div>
            <div class="p-3 bg-blue-100 rounded-full">
                <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
            </div>
        </div>
    </div>
    
    <!-- Active Users (green) -->
    <div class="bg-green-50 rounded-lg shadow-sm border border-green-200 p-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-green-700">Active</p>
                <p class="text-3xl font-bold text-green-600">{{ active_users }}</p>
            </div>
            <div class="p-3 bg-green-200 rounded-full">
                <svg class="w-8 h-8 text-green-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
            </div>
        </div>
    </div>
    
    <!-- Inactive Users (gray) -->
    <!-- Admins (purple) -->
    <!-- End Users (blue) -->
</div>

2. Search & Filter Bar

<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="md:col-span-2">
            <input type="search" id="user-search" placeholder="Search by name, email, or department..." 
                   class="w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500">
        </div>
        <select id="role-filter" class="rounded-md border-gray-300">
            <option value="">All Roles</option>
            <option value="admin">Admin</option>
            <option value="end_user">End User</option>
        </select>
        <select id="status-filter" class="rounded-md border-gray-300">
            <option value="">All Status</option>
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
        </select>
    </div>
    <div class="mt-4 flex justify-between items-center">
        <button onclick="openCreateUserModal()" class="btn-primary">
            + Create New User
        </button>
        <div class="space-x-2">
            <button onclick="bulkActivate()" class="btn-secondary" id="bulk-activate-btn" disabled>
                Activate Selected
            </button>
            <button onclick="bulkDeactivate()" class="btn-secondary" id="bulk-deactivate-btn" disabled>
                Deactivate Selected
            </button>
            <button onclick="exportUsers()" class="btn-secondary">
                üì• Export to Excel
            </button>
        </div>
    </div>
</div>

3. Enhanced Users Table

<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-6 py-3 text-left">
                    <input type="checkbox" id="select-all" class="rounded">
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" onclick="sortTable('fullname')">
                    User ‚Üï
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer" onclick="sortTable('department')">
                    Department ‚Üï
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Role
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Status
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Last Login
                </th>
                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Actions
                </th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for user in users %}
            <tr class="hover:bg-gray-50 transition">
                <td class="px-6 py-4">
                    <input type="checkbox" class="user-checkbox rounded" value="{{ user.id }}">
                </td>
                <td class="px-6 py-4">
                    <div class="flex items-center">
                        <div class="h-10 w-10 flex-shrink-0">
                            <div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                                <span class="text-blue-600 font-semibold">{{ user.fullname|slice:":1" }}</span>
                            </div>
                        </div>
                        <div class="ml-4">
                            <div class="text-sm font-medium text-gray-900">{{ user.fullname }}</div>
                            <div class="text-sm text-gray-500">{{ user.email }}</div>
                        </div>
                    </div>
                </td>
                <td class="px-6 py-4">
                    <div class="text-sm text-gray-900">{{ user.department }}</div>
                    <div class="text-xs text-gray-500">{{ user.position }}</div>
                </td>
                <td class="px-6 py-4">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                        {% if user.role == 'admin' %}bg-purple-100 text-purple-800
                        {% else %}bg-blue-100 text-blue-800{% endif %}">
                        {{ user.role|title }}
                    </span>
                </td>
                <td class="px-6 py-4">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                        {% if user.is_active %}bg-green-100 text-green-800
                        {% else %}bg-gray-100 text-gray-800{% endif %}">
                        {% if user.is_active %}Active{% else %}Inactive{% endif %}
                    </span>
                </td>
                <td class="px-6 py-4 text-sm text-gray-500">
                    {{ user.last_login|date:"M d, Y"|default:"Never" }}
                </td>
                <td class="px-6 py-4 text-right text-sm font-medium">
                    <div class="flex justify-end space-x-2">
                        <button onclick="viewUserDetails({{ user.id }})" class="text-blue-600 hover:text-blue-900">View</button>
                        <button onclick="editUser({{ user.id }})" class="text-indigo-600 hover:text-indigo-900">Edit</button>
                        <button onclick="toggleUserStatus({{ user.id }})" class="text-green-600 hover:text-green-900">
                            {% if user.is_active %}Deactivate{% else %}Activate{% endif %}
                        </button>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- Pagination -->
    <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t">
        <div class="text-sm text-gray-700">
            Showing {{ users.start_index }} to {{ users.end_index }} of {{ users.paginator.count }} users
        </div>
        <div class="flex space-x-2">
            <!-- Pagination buttons -->
        </div>
    </div>
</div>

4. Create User Modal

<div id="createUserModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold">Create New User</h3>
        </div>
        <form id="createUserForm" class="p-6 space-y-4">
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name *</label>
                    <input type="text" name="fullname" required class="w-full rounded-md border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                    <input type="email" name="email" required class="w-full rounded-md border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Username *</label>
                    <input type="text" name="username" required class="w-full rounded-md border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password *</label>
                    <input type="password" name="password" required class="w-full rounded-md border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Department *</label>
                    <input type="text" name="department" required class="w-full rounded-md border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                    <input type="text" name="position" class="w-full rounded-md border-gray-300">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Role *</label>
                    <select name="role" required class="w-full rounded-md border-gray-300">
                        <option value="">Select Role</option>
                        <option value="admin">Admin</option>
                        <option value="end_user">End User</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                    <select name="is_active" class="w-full rounded-md border-gray-300">
                        <option value="true">Active</option>
                        <option value="false">Inactive</option>
                    </select>
                </div>
            </div>
            <div class="flex justify-end space-x-3 pt-4 border-t">
                <button type="button" onclick="closeCreateUserModal()" class="btn-secondary">Cancel</button>
                <button type="submit" class="btn-primary">Create User</button>
            </div>
        </form>
    </div>
</div>

5. Backend View Updates

File: apps/admin_panel/views.py

Update client_accounts view:

@role_required('admin', login_url='/admin/')
def client_accounts(request):
    """Enhanced user accounts management with search, filters, and stats"""
    # Get filter parameters
    search_query = request.GET.get('search', '')
    role_filter = request.GET.get('role', '')
    status_filter = request.GET.get('status', '')
    department_filter = request.GET.get('department', '')
    
    # Base queryset
    users = User.objects.all().order_by('-date_joined')
    
    # Apply filters
    if search_query:
        users = users.filter(
            Q(fullname__icontains=search_query) |
            Q(email__icontains=search_query) |
            Q(department__icontains=search_query)
        )
    if role_filter:
        users = users.filter(role=role_filter)
    if status_filter == 'active':
        users = users.filter(is_active=True)
    elif status_filter == 'inactive':
        users = users.filter(is_active=False)
    if department_filter:
        users = users.filter(department=department_filter)
    
    # Calculate stats
    all_users = User.objects.all()
    stats = {
        'total_users': all_users.count(),
        'active_users': all_users.filter(is_active=True).count(),
        'inactive_users': all_users.filter(is_active=False).count(),
        'admin_count': all_users.filter(role='admin').count(),
        'end_user_count': all_users.filter(role='end_user').count(),
    }
    
    # Get unique departments
    departments = User.objects.values_list('department', flat=True).distinct()
    
    # Pagination
    paginator = Paginator(users, 20)
    page = request.GET.get('page', 1)
    users_page = paginator.get_page(page)
    
    context = {
        'users': users_page,
        'stats': stats,
        'departments': departments,
        'current_search': search_query,
        'current_role': role_filter,
        'current_status': status_filter,
        'current_department': department_filter,
    }
    
    return render(request, 'admin_panel/client_accounts.html', context)

Add new AJAX views:

@role_required('admin', login_url='/admin/')
def create_user_ajax(request):
    """AJAX endpoint to create new user"""
    if request.method == 'POST':
        # Handle user creation
        pass

@role_required('admin', login_url='/admin/')
def edit_user_ajax(request, user_id):
    """AJAX endpoint to edit user"""
    pass

@role_required('admin', login_url='/admin/')
def toggle_user_status(request, user_id):
    """AJAX endpoint to activate/deactivate user"""
    pass

@role_required('admin', login_url='/admin/')
def delete_user_ajax(request, user_id):
    """AJAX endpoint to delete user"""
    pass

@role_required('admin', login_url='/admin/')
def export_users_excel(request):
    """Export users to Excel"""
    pass



Features to Implement





‚úÖ Summary cards with user counts



‚úÖ Search bar with real-time filtering



‚úÖ Filter dropdowns (Role, Status, Department)



‚úÖ Enhanced table with badges and avatars



‚úÖ Sortable columns



‚úÖ Pagination (20 per page)



‚úÖ Bulk selection checkboxes



‚úÖ Create User modal with AJAX



‚úÖ Edit User modal with AJAX



‚úÖ User Details modal with activity stats



‚úÖ Toggle status (AJAX)



‚úÖ Delete user (AJAX with confirmation)



‚úÖ Bulk actions (activate, deactivate)



‚úÖ Export to Excel



‚úÖ Responsive design



‚úÖ Loading states and notifications



Design Guidelines





Use Tailwind CSS (already in project)



Match existing admin panel design



Color scheme:






Admin role: Purple



End User role: Blue



Active status: Green



Inactive status: Gray



Professional, clean, modern UI



Mobile responsive



AJAX for all actions (no page reload)